---
title: "DataScience - Honey Productionin the USA"
author: "Martina Djordjijevic"
date: "2022-09-28"
output: 
  github_document:
    toc: true
---

# Introduction


![](closeup-shot-bee-chamomile-flower.jpg)




# Methods

```{r, include=TRUE}
honey <- read.csv("honeyproduction.csv")
library(ggplot2)
library(tidyverse)
library(data.table)
library(dplyr)
state_variance <- honey %>% group_by(state) %>% summarize (variance=var(numcol))
state_count <- honey %>% group_by(state) %>% summarize (count=n())
total_variance <- honey %>% summarize (variance=var(numcol))
state_poundered_mean_variance <- sum(state_variance[,2]*state_count[,2])/sum(state_count[,2])
correlation_state_numcol <- round((1 - (state_poundered_mean_variance/total_variance)), 3)
correlation_state_numcol[1,1]
```



# Results

```{r, include=TRUE}
library(usmap)
library(ggplot2)
honey <- read.csv("honeyproduction.csv")
plot_usmap(data = honey, values = "totalprod", color = "black") + 
  scale_fill_continuous(low = "blue", high = "yellow", name = "totalprod", label = scales::comma) + 
  theme(legend.position = "right")


```

```{r, include=TRUE}

library(tidyverse)
honey <- read.csv("honeyproduction.csv")

str(honey)
honey %>% select(year, totalprod) %>%
 group_by(year) %>%
 summarize(total = sum(totalprod/2000)) %>%
 ggplot(aes(year, total))+
 geom_line(lwd = 2, color = 'midnightblue')+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(breaks = seq(from = 70000, to = 110000, by = 5000))+
 labs(y = 'tons', x = '')+
 theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1),
       panel.grid.major.x = element_blank())

```
```{r, include=TRUE}
library(dplyr)
library(ggplot2)

honey %>%
 mutate(percent = totalprod / sum(totalprod)) %>%
 group_by(year) %>%
 summarize(totperc = sum(percent)) %>%
 ggplot(aes(year, totperc))+
 geom_line(lwd = 2, color = 'midnightblue')+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(limits = c(0,NA),
                    labels = scales::percent_format())+
 labs(y = '', x = '')+
 theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1),
       panel.grid.major.x = element_blank())
```
```{r, include=TRUE}

library(dplyr)
library(ggplot2)
honey %>% select(year, numcol, totalprod) %>%
 group_by(year) %>%
 summarize(totColo = sum(numcol),
           totProd = sum(totalprod)) %>%
ggplot(aes(year))+
 geom_line(aes(y = totColo/25), lwd = 1.5, color = 'orange')+
 geom_line(aes(y = totProd/2000), lwd = 1.5, color = 'green')+
 theme(axis.text.y = element_text(size = 15))+
 labs(y = 'orange = colonies x 25, green = production tons')+
 scale_x_continuous(breaks = seq(from = 1998, to = 2012, by = 1))+
 scale_y_continuous(breaks = seq(from = 70000, to = 110000, by = 5000))
```

```{r, include=TRUE}

library(dplyr)
library(ggplot2)

honey %>% select(state, totalprod) %>%
 group_by(state) %>%
 summarize(total = sum(totalprod/2000)) %>%
 arrange(desc(total)) %>% head(20) %>%
 ggplot(aes(reorder(state, -total), total, fill = state))+
 geom_bar(stat = 'identity')+
 scale_y_continuous(breaks = seq(from = 0, to = 250000, by = 25000))+
 labs(y = 'TONS', x = '')+
 theme(legend.position = "none",
       panel.grid.major = element_blank(),
       axis.text.x = element_text(size = 13),
       axis.text.y = element_text(size = 13))
```

```{r, include=TRUE}

library(dplyr)
library(ggplot2)
honey %>% group_by(state, numcol, year) %>%
 summarize(total = sum(numcol/10), .groups = 'keep') %>%
 arrange(desc(total)) %>% head(100) %>%
 ggplot(aes(year, numcol, group = state, color = state))+
 geom_line(lwd = 2)+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(breaks = seq(from = 50000, to = 550000, by = 50000))+
 labs(y = 'colonies/state/year', x = '')+
 theme(axis.text.y = element_text(size = 14))+
 ggtitle(label = 'Colonies per state')
```

```{r, include=TRUE}

library(dplyr)
library(ggplot2)
honey %>% group_by(state, totalprod, year) %>%
 summarize(total = sum(totalprod), .groups = 'keep') %>%
 arrange(desc(total)) %>% head(100) %>%
 ggplot(aes(year, total, group = state, color = state))+
 geom_line(lwd = 2)+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(labels = scales::label_number_si())+
 labs(y = 'prod/state/year', x = '')+
 ggtitle(label = 'Production per state')+
 theme(axis.text.y = element_text(size = 14))
```





# Conclusion

# References
<a href="https://www.freepik.com/free-photo/closeup-shot-bee-chamomile-flower_13411366.htm#query=bee&position=29&from_view=search&track=sph">Image by wirestock</a> on Freepik
