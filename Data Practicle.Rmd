---
title: "DataScience - Honey Productionin the USA"
author: "Martina Djordjijevic"
date: "2022-09-28"
output: 
  github_document:
    toc: true
---

# Introduction

Bees have been around for many millennia, however in most recent times the hardworking colonies face many trials and tribulations due to various factors such as an extensive use of pesticides, loss of habitat â€“ mostly because of rapid urbanization, unusually warm winters that cause a shift in plant development etc. The importance of these insects in the process of pollination is undeniable, valid for both wild bees and honeybees, hence the rapid decline in the number of their colonies presents a problem not only on the more global level in the nature, but also to the world agricultural output economic value. 

Back in 2006, there was a huge decline in the honeybee population reported mostly in North America, which had a huge impact on the American honey agriculture. This decline was due to the Colony Collapse Disorder, a phenomenon reported in many countries and continents since 1998. 

Let's take a look at Wikipedia's definition of this phenomenon:

>>>  Colony collapse disorder (CCD) is an abnormal phenomenon that occurs when the majority of worker bees in a honey bee colony disappear, leaving behind a queen, plenty of food, and a few nurse bees to care for the remaining immature bees.

It is important to note that this phenomenon also causes the remaining hive colony to collapse. The cause of the decline of 2006 is probably to be found in hive diseases and pesticides harming the pollinators, as these two processes are highly correlated, though no real consensus was reached. Ever since the collapse, the American honey industry has been largely struggling. After the collapse the U.S. is forced to import large amounts of honey, more precisely 350 of the 400 million pounds each year, which is in stark contrast to this industries brilliant past when almost half the honey consumed was produced locally.

The dataset analysed here gives insight into honey production supply and demand in America by state from 1998 to 2012.

![](closeup-shot-bee-chamomile-flower.jpg)




# Data analysis

Firstly, let's take a quick look at the data we'll be analyzing.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
honey <- read.csv("honeyproduction.csv")
head(honey)
```
Here's also a description of each column's content:

* *numcol*: Number of honey producing colonies, more precisely the maximum number of colonies from which honey was taken during the year.
* *yieldpercol*: Honey yield in pounds per colony.
* *totalprod*: Total production in pounds (numcol x yieldpercol).
* *stocks*: Refers to stocks in pounds held by producers.
* *priceperlb*: Refers to average price per pound, in dollars, based on expanded sales.
* *prodvalue*: Value of production in dollars (totalprod x priceperlb).

This dataset is rather rich in information. However the first thing I'd like to investigate further is the relationship between the states and number of honey producing colonies. 
Here let's assume a **H0** - *states have no impact on the number of honey producing colonies.* Followed by a **H1** - *states do have an impact on the number of honey producing colonies.*
Let's plot a boxplot of state and numcol to verify this.


```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

ggplot(honey, aes(state, numcol))+
  geom_boxplot(aes(fill = state), show.legend = FALSE)+
  labs(x="State", y="Number of honey producing colonies")+
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1))+
  scale_y_continuous(labels = scales::label_number_si())

```

The boxplot indicates that there could be some statistical difference between the variables. To confirm this, let's calculate the correlation between states and number of honey producing colonies with an ANOVA. 



```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggpubr)
library(tidyverse)
library(broom)

honey <- read.csv("honeyproduction.csv")
one.way <- aov(numcol ~ state, data = honey)
summary(one.way)

```

Because the **p-value** is significantly lower than alpha of 0.05, we can reject the **H0** and conclude that there is a significant statistical difference between the number of colonies in each state.




# Results

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(usmap)
library(ggplot2)
honey <- read.csv("honeyproduction.csv")
plot_usmap(data = honey, values = "totalprod", color = "black") + 
  scale_fill_continuous(low = "blue", high = "yellow", name = "Total production in lb", label = scales::comma) + 
  theme(legend.position = "right")


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(dplyr)
library(ggplot2)

honey %>% select(state, totalprod) %>%
 group_by(state) %>%
 summarize(total = sum(totalprod/2000)) %>%
 arrange(desc(total)) %>% head(20) %>%
 ggplot(aes(reorder(state, -total), total, fill = state))+
 geom_bar(stat = 'identity')+
 scale_y_continuous(breaks = seq(from = 0, to = 250000, by = 25000))+
 labs(y = 'TONS', x = '')+
 theme(legend.position = "none",
       panel.grid.major = element_blank(),
       axis.text.x = element_text(size = 13),
       axis.text.y = element_text(size = 13))
```


Which states produce the most honey? In this plot we can see top 20 states in honey production, with North Dakota(ND), California(CA) South Dakota(sd) and Florida(FL) as the four major states producing honey.

# Trends in data


```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(tidyverse)
honey <- read.csv("honeyproduction.csv")

str(honey)
honey %>% select(year, totalprod) %>%
 group_by(year) %>%
 summarize(total = sum(totalprod/2000)) %>%
 ggplot(aes(year, total))+
 geom_smooth(method = "lm")+
 geom_line(lwd = 2, color = 'red')+
 geom_point() +
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(breaks = seq(from = 70000, to = 110000, by = 5000))+
 labs(y = 'tons', x = '')+
 theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1),
       panel.grid.major.x = element_blank())

```



As seen from the plot, honey production has been decreasing over time. 



```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(tidyverse)
honey <- read.csv("honeyproduction.csv")


price <- honey %>%
  group_by(year) %>% 
  summarise(YearAvgPrice=mean(priceperlb))

 ggplot(data= price, aes(year, YearAvgPrice))+
 geom_smooth(method = "lm") + 
  geom_line(color = "red", size = 2) +
  geom_point() +
  scale_x_continuous(breaks=seq(1998, 2012, 2)) +
  ylab("Prices (Avg)") +
  xlab("Years")

```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)

honey %>%
 mutate(percent = totalprod / sum(totalprod)) %>%
 group_by(year) %>%
 summarize(totperc = sum(percent)) %>%
 ggplot(aes(year, totperc))+
 geom_line(lwd = 2, color = 'midnightblue')+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(limits = c(0,NA),
                    labels = scales::percent_format())+
 labs(y = '', x = '')+
 theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1),
       panel.grid.major.x = element_blank())
```
```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(dplyr)
library(ggplot2)
honey %>% select(year, numcol, totalprod) %>%
 group_by(year) %>%
 summarize(totColo = sum(numcol),
           totProd = sum(totalprod)) %>%
ggplot(aes(year))+
 geom_line(aes(y = totColo/25), lwd = 1.5, color = 'orange')+
 geom_line(aes(y = totProd/2000), lwd = 1.5, color = 'green')+
 theme(axis.text.y = element_text(size = 15))+
 labs(y = 'orange = colonies x 25, green = production tons')+
 scale_x_continuous(breaks = seq(from = 1998, to = 2012, by = 1))+
 scale_y_continuous(breaks = seq(from = 70000, to = 110000, by = 5000))
```







```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(dplyr)
library(ggplot2)
honey %>% group_by(state, numcol, year) %>%
 summarize(total = sum(numcol/10), .groups = 'keep') %>%
 arrange(desc(total)) %>% head(100) %>%
 ggplot(aes(year, numcol, group = state, color = state))+
 geom_line(lwd = 2)+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(breaks = seq(from = 50000, to = 550000, by = 50000))+
 labs(y = 'colonies/state', x = 'year')+
 theme(axis.text.y = element_text(size = 14))+
 ggtitle(label = 'Colonies per state')
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(dplyr)
library(ggplot2)
honey %>% group_by(state, totalprod, year) %>%
 summarize(total = sum(totalprod), .groups = 'keep') %>%
 arrange(desc(total)) %>% head(100) %>%
 ggplot(aes(year, total, group = state, color = state))+
 geom_line(lwd = 2)+
 scale_x_continuous(breaks = 1998:2012)+
 scale_y_continuous(labels = scales::label_number_si())+
 labs(y = 'prod/state/year', x = '')+
 ggtitle(label = 'Production per state')+
 theme(axis.text.y = element_text(size = 14))
```





# Conclusion

# References

The clean version of this dataset was provided by Kaggle, however the original raw dataset was from the USDA's National Agricultural Statistics Service (NASS). 

<a href="https://www.freepik.com/free-photo/closeup-shot-bee-chamomile-flower_13411366.htm#query=bee&position=29&from_view=search&track=sph">Image by wirestock</a> on Freepik
